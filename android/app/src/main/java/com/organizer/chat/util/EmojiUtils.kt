package com.organizer.chat.util

object EmojiUtils {

    private val EMOTICON_MAP = mapOf(
        ":-)" to "ğŸ˜Š",
        ":)" to "ğŸ˜Š",
        ":-(" to "ğŸ˜",
        ":(" to "ğŸ˜",
        ":-D" to "ğŸ˜ƒ",
        ":D" to "ğŸ˜ƒ",
        ":-d" to "ğŸ˜ƒ",
        ":d" to "ğŸ˜ƒ",
        ":-P" to "ğŸ˜›",
        ":P" to "ğŸ˜›",
        ":-p" to "ğŸ˜›",
        ":p" to "ğŸ˜›",
        ":-/" to "ğŸ˜•",
        ":/" to "ğŸ˜•",
        ":-O" to "ğŸ˜®",
        ":O" to "ğŸ˜®",
        ":-o" to "ğŸ˜®",
        ":o" to "ğŸ˜®",
        ":-*" to "ğŸ˜˜",
        ":*" to "ğŸ˜˜",
        ";-)" to "ğŸ˜‰",
        ";)" to "ğŸ˜‰",
        "B-)" to "ğŸ˜",
        "B)" to "ğŸ˜",
        "<3" to "â¤ï¸",
        "xD" to "ğŸ˜†",
        "XD" to "ğŸ˜†",
        "xd" to "ğŸ˜†",
        ":xD" to "ğŸ˜†",
        ":XD" to "ğŸ˜†",
        ":xd" to "ğŸ˜†",
        "^^" to "ğŸ˜Š",
        "Xd" to "ğŸ˜†",
        "=)" to "ğŸ˜Š",
        "=D" to "ğŸ˜ƒ",
        "=d" to "ğŸ˜ƒ",
        "=(" to "ğŸ˜",
        "=/" to "ğŸ˜•",
        "=P" to "ğŸ˜›",
        "=p" to "ğŸ˜›",
        "=O" to "ğŸ˜®",
        "=o" to "ğŸ˜®",
        ":'(" to "ğŸ˜¢",
        ":'-(" to "ğŸ˜¢",
        ":-|" to "ğŸ˜",
        ":|" to "ğŸ˜",
        "-_-" to "ğŸ˜‘",
        ">:(" to "ğŸ˜ ",
        ">:-(" to "ğŸ˜ ",
        "o_o" to "ğŸ˜³",
        "O_O" to "ğŸ˜³",
        "</3" to "ğŸ’”",
        "b-)" to "ğŸ˜",
        "b)" to "ğŸ˜",
        ":-]" to "ğŸ˜Š",
        ":]" to "ğŸ˜Š",
        ":-[" to "ğŸ˜",
        ":[" to "ğŸ˜",
        "lol" to "lol ğŸ˜†",
        "LOL" to "LOL ğŸ˜†",
        "Lol" to "Lol ğŸ˜†",
        "mdr" to "mdr ğŸ˜†",
        "MDR" to "MDR ğŸ˜†",
        "Mdr" to "Mdr ğŸ˜†",
    )

    private val SHORTCODE_MAP = mapOf(
        // Smileys & People
        "smile" to "ğŸ˜Š",
        "laughing" to "ğŸ˜†",
        "blush" to "ğŸ˜Š",
        "smiley" to "ğŸ˜ƒ",
        "relaxed" to "â˜ºï¸",
        "smirk" to "ğŸ˜",
        "heart_eyes" to "ğŸ˜",
        "kissing_heart" to "ğŸ˜˜",
        "kissing" to "ğŸ˜—",
        "wink" to "ğŸ˜‰",
        "stuck_out_tongue_winking_eye" to "ğŸ˜œ",
        "stuck_out_tongue" to "ğŸ˜›",
        "flushed" to "ğŸ˜³",
        "grinning" to "ğŸ˜€",
        "grin" to "ğŸ˜",
        "joy" to "ğŸ˜‚",
        "rofl" to "ğŸ¤£",
        "sweat_smile" to "ğŸ˜…",
        "sob" to "ğŸ˜­",
        "cry" to "ğŸ˜¢",
        "angry" to "ğŸ˜ ",
        "rage" to "ğŸ˜¡",
        "triumph" to "ğŸ˜¤",
        "sleepy" to "ğŸ˜ª",
        "yum" to "ğŸ˜‹",
        "mask" to "ğŸ˜·",
        "sunglasses" to "ğŸ˜",
        "dizzy_face" to "ğŸ˜µ",
        "imp" to "ğŸ‘¿",
        "smiling_imp" to "ğŸ˜ˆ",
        "neutral_face" to "ğŸ˜",
        "no_mouth" to "ğŸ˜¶",
        "innocent" to "ğŸ˜‡",
        "alien" to "ğŸ‘½",
        "yellow_heart" to "ğŸ’›",
        "blue_heart" to "ğŸ’™",
        "purple_heart" to "ğŸ’œ",
        "heart" to "â¤ï¸",
        "green_heart" to "ğŸ’š",
        "broken_heart" to "ğŸ’”",
        "heartbeat" to "ğŸ’“",
        "heartpulse" to "ğŸ’—",
        "sparkling_heart" to "ğŸ’–",
        "cupid" to "ğŸ’˜",
        "revolving_hearts" to "ğŸ’",
        "thinking" to "ğŸ¤”",
        "thinking_face" to "ğŸ¤”",
        "skull" to "ğŸ’€",
        "poop" to "ğŸ’©",
        "ghost" to "ğŸ‘»",
        "eyes" to "ğŸ‘€",
        "tongue" to "ğŸ‘…",
        "pleading_face" to "ğŸ¥º",
        "face_with_tears_of_joy" to "ğŸ˜‚",
        "upside_down_face" to "ğŸ™ƒ",
        "money_mouth_face" to "ğŸ¤‘",
        "nerd_face" to "ğŸ¤“",
        "hugs" to "ğŸ¤—",
        "shush" to "ğŸ¤«",
        "shushing_face" to "ğŸ¤«",
        "zipper_mouth_face" to "ğŸ¤",
        "raised_eyebrow" to "ğŸ¤¨",
        "monocle_face" to "ğŸ§",
        "grimacing" to "ğŸ˜¬",
        "rolling_eyes" to "ğŸ™„",
        "exploding_head" to "ğŸ¤¯",
        "partying_face" to "ğŸ¥³",
        "woozy_face" to "ğŸ¥´",
        "hot_face" to "ğŸ¥µ",
        "cold_face" to "ğŸ¥¶",
        "clown_face" to "ğŸ¤¡",
        "yawning_face" to "ğŸ¥±",
        "saluting_face" to "ğŸ«¡",
        "melting_face" to "ğŸ« ",

        // Gestures
        "thumbsup" to "ğŸ‘",
        "+1" to "ğŸ‘",
        "thumbsdown" to "ğŸ‘",
        "-1" to "ğŸ‘",
        "ok_hand" to "ğŸ‘Œ",
        "punch" to "ğŸ‘Š",
        "fist" to "âœŠ",
        "v" to "âœŒï¸",
        "wave" to "ğŸ‘‹",
        "hand" to "âœ‹",
        "open_hands" to "ğŸ‘",
        "point_up" to "â˜ï¸",
        "point_down" to "ğŸ‘‡",
        "point_left" to "ğŸ‘ˆ",
        "point_right" to "ğŸ‘‰",
        "raised_hands" to "ğŸ™Œ",
        "pray" to "ğŸ™",
        "clap" to "ğŸ‘",
        "muscle" to "ğŸ’ª",
        "metal" to "ğŸ¤˜",
        "middle_finger" to "ğŸ–•",
        "writing_hand" to "âœï¸",
        "handshake" to "ğŸ¤",
        "crossed_fingers" to "ğŸ¤",
        "pinching_hand" to "ğŸ¤",
        "love_you_gesture" to "ğŸ¤Ÿ",
        "call_me_hand" to "ğŸ¤™",
        "brain" to "ğŸ§ ",

        // Nature & Animals
        "dog" to "ğŸ¶",
        "cat" to "ğŸ±",
        "mouse" to "ğŸ­",
        "hamster" to "ğŸ¹",
        "rabbit" to "ğŸ°",
        "bear" to "ğŸ»",
        "panda_face" to "ğŸ¼",
        "chicken" to "ğŸ”",
        "penguin" to "ğŸ§",
        "bird" to "ğŸ¦",
        "monkey_face" to "ğŸµ",
        "see_no_evil" to "ğŸ™ˆ",
        "hear_no_evil" to "ğŸ™‰",
        "speak_no_evil" to "ğŸ™Š",
        "pig" to "ğŸ·",
        "frog" to "ğŸ¸",
        "snake" to "ğŸ",
        "turtle" to "ğŸ¢",
        "unicorn" to "ğŸ¦„",
        "bee" to "ğŸ",
        "bug" to "ğŸ›",
        "butterfly" to "ğŸ¦‹",
        "fish" to "ğŸŸ",
        "whale" to "ğŸ³",
        "dolphin" to "ğŸ¬",
        "octopus" to "ğŸ™",
        "fox_face" to "ğŸ¦Š",
        "wolf" to "ğŸº",
        "lion" to "ğŸ¦",

        // Nature & Weather
        "sun" to "â˜€ï¸",
        "sunny" to "â˜€ï¸",
        "cloud" to "â˜ï¸",
        "snowflake" to "â„ï¸",
        "zap" to "âš¡",
        "rainbow" to "ğŸŒˆ",
        "star" to "â­",
        "star2" to "ğŸŒŸ",
        "sparkles" to "âœ¨",
        "moon" to "ğŸŒ™",
        "earth_americas" to "ğŸŒ",
        "fire" to "ğŸ”¥",
        "boom" to "ğŸ’¥",
        "droplet" to "ğŸ’§",
        "ocean" to "ğŸŒŠ",
        "leaves" to "ğŸƒ",
        "fallen_leaf" to "ğŸ‚",
        "herb" to "ğŸŒ¿",
        "cherry_blossom" to "ğŸŒ¸",
        "rose" to "ğŸŒ¹",
        "sunflower" to "ğŸŒ»",
        "hibiscus" to "ğŸŒº",
        "tulip" to "ğŸŒ·",
        "seedling" to "ğŸŒ±",
        "evergreen_tree" to "ğŸŒ²",
        "cactus" to "ğŸŒµ",
        "mushroom" to "ğŸ„",

        // Food & Drink
        "pizza" to "ğŸ•",
        "hamburger" to "ğŸ”",
        "fries" to "ğŸŸ",
        "beer" to "ğŸº",
        "beers" to "ğŸ»",
        "wine_glass" to "ğŸ·",
        "coffee" to "â˜•",
        "tea" to "ğŸµ",
        "cake" to "ğŸ°",
        "cookie" to "ğŸª",
        "chocolate_bar" to "ğŸ«",
        "apple" to "ğŸ",
        "banana" to "ğŸŒ",
        "watermelon" to "ğŸ‰",
        "grapes" to "ğŸ‡",
        "strawberry" to "ğŸ“",
        "peach" to "ğŸ‘",
        "popcorn" to "ğŸ¿",
        "icecream" to "ğŸ¦",
        "taco" to "ğŸŒ®",
        "burrito" to "ğŸŒ¯",
        "egg" to "ğŸ¥š",
        "avocado" to "ğŸ¥‘",
        "croissant" to "ğŸ¥",

        // Objects & Symbols
        "100" to "ğŸ’¯",
        "checkmark" to "âœ”ï¸",
        "white_check_mark" to "âœ…",
        "x" to "âŒ",
        "cross_mark" to "âŒ",
        "warning" to "âš ï¸",
        "exclamation" to "â—",
        "question" to "â“",
        "bulb" to "ğŸ’¡",
        "wrench" to "ğŸ”§",
        "hammer" to "ğŸ”¨",
        "gear" to "âš™ï¸",
        "link" to "ğŸ”—",
        "key" to "ğŸ”‘",
        "lock" to "ğŸ”’",
        "unlock" to "ğŸ”“",
        "bell" to "ğŸ””",
        "bookmark" to "ğŸ”–",
        "paperclip" to "ğŸ“",
        "scissors" to "âœ‚ï¸",
        "pencil" to "âœï¸",
        "pen" to "ğŸ–Šï¸",
        "book" to "ğŸ“–",
        "memo" to "ğŸ“",
        "clipboard" to "ğŸ“‹",
        "calendar" to "ğŸ“…",
        "pushpin" to "ğŸ“Œ",
        "mag" to "ğŸ”",
        "flashlight" to "ğŸ”¦",

        // Transport & Travel
        "rocket" to "ğŸš€",
        "airplane" to "âœˆï¸",
        "car" to "ğŸš—",
        "taxi" to "ğŸš•",
        "bus" to "ğŸšŒ",
        "bike" to "ğŸš²",
        "train" to "ğŸš†",
        "ship" to "ğŸš¢",
        "anchor" to "âš“",
        "house" to "ğŸ ",

        // Activities & Sports
        "soccer" to "âš½",
        "basketball" to "ğŸ€",
        "football" to "ğŸˆ",
        "baseball" to "âš¾",
        "tennis" to "ğŸ¾",
        "trophy" to "ğŸ†",
        "medal" to "ğŸ…",
        "crown" to "ğŸ‘‘",
        "gem" to "ğŸ’",
        "guitar" to "ğŸ¸",
        "microphone" to "ğŸ¤",
        "headphones" to "ğŸ§",
        "video_game" to "ğŸ®",
        "dart" to "ğŸ¯",
        "tada" to "ğŸ‰",
        "confetti_ball" to "ğŸŠ",
        "balloon" to "ğŸˆ",
        "gift" to "ğŸ",
        "art" to "ğŸ¨",
        "ribbon" to "ğŸ€",
        "movie_camera" to "ğŸ¥",
        "camera" to "ğŸ“·",

        // Flags & Misc
        "flag_fr" to "ğŸ‡«ğŸ‡·",
        "flag_us" to "ğŸ‡ºğŸ‡¸",
        "flag_gb" to "ğŸ‡¬ğŸ‡§",
        "flag_de" to "ğŸ‡©ğŸ‡ª",
        "flag_es" to "ğŸ‡ªğŸ‡¸",
        "flag_it" to "ğŸ‡®ğŸ‡¹",
        "flag_jp" to "ğŸ‡¯ğŸ‡µ",

        // Tech
        "computer" to "ğŸ’»",
        "iphone" to "ğŸ“±",
        "keyboard" to "âŒ¨ï¸",
        "robot" to "ğŸ¤–",
        "satellite" to "ğŸ›°ï¸",
        "electric_plug" to "ğŸ”Œ",
        "battery" to "ğŸ”‹",
        "cd" to "ğŸ’¿",
        "floppy_disk" to "ğŸ’¾",

        // Hearts & Love
        "two_hearts" to "ğŸ’•",
        "gift_heart" to "ğŸ’",
        "heart_decoration" to "ğŸ’Ÿ",
        "heavy_heart_exclamation" to "â£ï¸",
        "love_letter" to "ğŸ’Œ",
        "kiss" to "ğŸ’‹",
        "ring" to "ğŸ’",
        "bouquet" to "ğŸ’",
        "couple" to "ğŸ‘«",

        // Misc popular
        "zzz" to "ğŸ’¤",
        "anger" to "ğŸ’¢",
        "sweat_drops" to "ğŸ’¦",
        "notes" to "ğŸ¶",
        "musical_note" to "ğŸµ",
        "no_entry" to "â›”",
        "stop_sign" to "ğŸ›‘",
        "construction" to "ğŸš§",
        "rotating_light" to "ğŸš¨",
        "loudspeaker" to "ğŸ“¢",
        "mega" to "ğŸ“£",
        "speech_balloon" to "ğŸ’¬",
        "thought_balloon" to "ğŸ’­",
        "wave_dash" to "ã€°ï¸",
        "recycle" to "â™»ï¸",
        "infinity" to "â™¾ï¸",
        "peace" to "â˜®ï¸",
        "atom" to "âš›ï¸",
        "hourglass" to "âŒ›",
        "timer" to "â±ï¸",
        "alarm_clock" to "â°",
        "stopwatch" to "â±ï¸",
        "clock" to "ğŸ•",
        "umbrella" to "â˜‚ï¸",
        "comet" to "â˜„ï¸",
        "volcano" to "ğŸŒ‹",
        "earth_africa" to "ğŸŒ",
        "earth_asia" to "ğŸŒ",
        "globe_with_meridians" to "ğŸŒ",
        "moyai" to "ğŸ—¿",
        "hot_pepper" to "ğŸŒ¶ï¸",
        "corn" to "ğŸŒ½",
        "lemon" to "ğŸ‹",
        "pineapple" to "ğŸ",
        "mango" to "ğŸ¥­",
        "coconut" to "ğŸ¥¥",
        "broccoli" to "ğŸ¥¦",
        "carrot" to "ğŸ¥•",
        "garlic" to "ğŸ§„",
        "onion" to "ğŸ§…",
        "cherries" to "ğŸ’",
        "kiwi" to "ğŸ¥",
        "tomato" to "ğŸ…",
        "eggplant" to "ğŸ†",
        "peanuts" to "ğŸ¥œ",
        "bread" to "ğŸ",
        "cheese" to "ğŸ§€",
        "meat_on_bone" to "ğŸ–",
        "ramen" to "ğŸœ",
        "sushi" to "ğŸ£",
        "dumpling" to "ğŸ¥Ÿ",
        "champagne" to "ğŸ¾",
        "cocktail" to "ğŸ¸",
        "tropical_drink" to "ğŸ¹",
        "milk" to "ğŸ¥›",
        "baby_bottle" to "ğŸ¼",
        "candy" to "ğŸ¬",
        "lollipop" to "ğŸ­",
        "doughnut" to "ğŸ©",
        "pie" to "ğŸ¥§",
        "birthday" to "ğŸ‚",
        "cupcake" to "ğŸ§",

        // Additional popular ones
        "thumbs_up" to "ğŸ‘",
        "thumbs_down" to "ğŸ‘",
        "fingers_crossed" to "ğŸ¤",
        "pinched_fingers" to "ğŸ¤Œ",
        "palms_up_together" to "ğŸ¤²",
        "nail_care" to "ğŸ’…",
        "selfie" to "ğŸ¤³",
        "dancer" to "ğŸ’ƒ",
        "man_dancing" to "ğŸ•º",
        "levitate" to "ğŸ•´ï¸",
        "sleeping" to "ğŸ˜´",
        "drooling_face" to "ğŸ¤¤",
        "nauseated_face" to "ğŸ¤¢",
        "sneezing_face" to "ğŸ¤§",
        "face_with_thermometer" to "ğŸ¤’",
        "nerd" to "ğŸ¤“",
        "cowboy" to "ğŸ¤ ",
        "detective" to "ğŸ•µï¸",
        "astronaut" to "ğŸ§‘â€ğŸš€",
        "santa" to "ğŸ…",
        "angel" to "ğŸ‘¼",
        "princess" to "ğŸ‘¸",
        "superhero" to "ğŸ¦¸",
        "mage" to "ğŸ§™",
        "fairy" to "ğŸ§š",
        "vampire" to "ğŸ§›",
        "zombie" to "ğŸ§Ÿ",
        "mermaid" to "ğŸ§œ",
        "elf" to "ğŸ§",
        "baby" to "ğŸ‘¶",
        "woman" to "ğŸ‘©",
        "man" to "ğŸ‘¨",
        "child" to "ğŸ§’",
        "older_adult" to "ğŸ§“",
        "person_frowning" to "ğŸ™",
        "person_shrugging" to "ğŸ¤·",
        "person_facepalming" to "ğŸ¤¦",
        "shrug" to "ğŸ¤·",
        "facepalm" to "ğŸ¤¦",
    )

    // Sort emoticon keys longest-first so ":-)" matches before ":)"
    private val sortedEmoticonKeys = EMOTICON_MAP.keys.sortedByDescending { it.length }

    // Compile emoticon regex once
    private val EMOTICON_REGEX: Regex = run {
        val pattern = sortedEmoticonKeys.joinToString("|") { Regex.escape(it) }
        """(?<=^|\s)(?:$pattern)(?=${'$'}|\s|[.,!?;:\])"'()])""".toRegex()
    }

    // Compile shortcode regex once: :name or :name: (optional closing colon)
    private val SHORTCODE_REGEX: Regex =
        """(?<=^|\s):([a-z0-9_+-]+):?(?=${'$'}|\s|[.,!?;\])"'()])""".toRegex()

    fun convertEmojis(text: String): String {
        var result = EMOTICON_REGEX.replace(text) { match ->
            EMOTICON_MAP[match.value] ?: match.value
        }
        result = SHORTCODE_REGEX.replace(result) { match ->
            SHORTCODE_MAP[match.groupValues[1]] ?: match.value
        }
        return result
    }
}
